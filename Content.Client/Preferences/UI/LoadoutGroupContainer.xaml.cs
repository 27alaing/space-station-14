using Content.Client.UserInterface.Controls;
using Content.Shared.Preferences.Loadouts;
using Robust.Client.AutoGenerated;
using Robust.Client.UserInterface.Controls;
using Robust.Client.UserInterface.XAML;
using Robust.Shared.Prototypes;

namespace Content.Client.Preferences.UI;

[GenerateTypedNameReferences]
public sealed partial class LoadoutGroupContainer : BoxContainer
{
    private readonly IPrototypeManager _protoManager;

    private LoadoutGroupPrototype _groupProto;

    public LoadoutGroupContainer(LoadoutGroupPrototype groupProto, IPrototypeManager protoManager)
    {
        RobustXamlLoader.Load(this);
        _protoManager = protoManager;
        _groupProto = groupProto;

        RefreshLoadouts();
    }

    public void RefreshLoadouts()
    {
        GroupName.Text = _groupProto.ID;
        LoadoutsContainer.DisposeAllChildren();
        var btnGroup = new ButtonGroup();

        if (_groupProto.Optional)
        {
            var btn = new Button()
            {
                Text = Loc.GetString("loadout-none"),
                ToggleMode = true,
                Group = btnGroup,
            };

            LoadoutsContainer.AddChild(btn);
        }

        foreach (var role in _groupProto.Loadouts)
        {
            var btn = new Button()
            {
                Text = role.Id,
                Disabled = false,
                ToggleMode = true,
                Group = btnGroup,
            };

            LoadoutsContainer.AddChild(btn);
        }
    }
}
